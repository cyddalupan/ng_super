"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6434],{6434:(O,_,l)=>{l.r(_),l.d(_,{UserPageModule:()=>w});var d=l(6895),s=l(4556),u=l(433),p=l(3013),c=l(5861),e=l(8256),m=l(5830),U=l(3949),Z=l(5970),x=l(7556);const h=["modal"];function v(o,a){if(1&o){const n=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",7),e._uU(2),e.qZA(),e.TgZ(3,"ion-col",7),e._uU(4),e.qZA(),e.TgZ(5,"ion-col",7),e._uU(6),e.qZA(),e.TgZ(7,"ion-col",11),e._uU(8),e.qZA(),e.TgZ(9,"ion-col",13)(10,"i",18),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.oxw().openModal(!0,r)}),e.qZA(),e.TgZ(11,"i",19),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.oxw().deleteUser(r.id)}),e.qZA()()()}if(2&o){const n=a.$implicit;e.xp6(2),e.Oqu(n.username),e.xp6(2),e.Oqu(n.email),e.xp6(2),e.Oqu(n.user_type),e.xp6(2),e.Oqu(n.agency_id||"None")}}function M(o,a){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",27),e._UZ(1,"ion-icon",42),e.TgZ(2,"ion-label",29),e._uU(3,"Password"),e.qZA(),e.TgZ(4,"ion-input",43),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw(2).selectedUser.password=i}),e.qZA()()}if(2&o){const n=e.oxw(2);e.xp6(4),e.Q6J("ngModel",n.selectedUser.password)}}function y(o,a){1&o&&e._UZ(0,"br")}function T(o,a){if(1&o&&(e.TgZ(0,"ion-select-option",40),e._uU(1),e.qZA()),2&o){const n=a.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.name)}}function b(o,a){if(1&o){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",20)(2,"ion-buttons",0)(3,"ion-button",21),e.NdJ("click",function(){return e.CHM(n),e.oxw().closeModal()}),e._UZ(4,"i",22),e._uU(5," Cancel "),e.qZA()(),e.TgZ(6,"ion-title"),e._uU(7),e.qZA(),e.TgZ(8,"ion-buttons",23)(9,"ion-button",24),e.NdJ("click",function(){return e.CHM(n),e.oxw().saveUser()}),e._UZ(10,"i",25),e._uU(11," Save "),e.qZA()()()(),e.TgZ(12,"ion-content",26)(13,"ion-item",27),e._UZ(14,"ion-icon",28),e.TgZ(15,"ion-label",29),e._uU(16,"Username"),e.qZA(),e.TgZ(17,"ion-input",30),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.username=i}),e.qZA()(),e._UZ(18,"br"),e.YNc(19,M,5,1,"ion-item",31),e.YNc(20,y,1,0,"br",32),e.TgZ(21,"ion-item",27),e._UZ(22,"ion-icon",33),e.TgZ(23,"ion-label",29),e._uU(24,"Email"),e.qZA(),e.TgZ(25,"ion-input",30),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.email=i}),e.qZA()(),e._UZ(26,"br"),e.TgZ(27,"ion-item",27),e._UZ(28,"ion-icon",34),e.TgZ(29,"ion-label",29),e._uU(30,"User Type"),e.qZA(),e.TgZ(31,"ion-select",30),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.user_type=i}),e.TgZ(32,"ion-select-option",35),e._uU(33,"Superuser"),e.qZA(),e.TgZ(34,"ion-select-option",36),e._uU(35,"Agency Manager"),e.qZA(),e.TgZ(36,"ion-select-option",37),e._uU(37,"Applicant"),e.qZA()()(),e._UZ(38,"br"),e.TgZ(39,"ion-item",27),e._UZ(40,"ion-icon",38),e.TgZ(41,"ion-label",29),e._uU(42,"Agency ID (optional)"),e.qZA(),e.TgZ(43,"ion-select",39),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.agency_id=i}),e.TgZ(44,"ion-select-option",40),e._uU(45,"None"),e.qZA(),e.YNc(46,T,2,2,"ion-select-option",41),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(7),e.Oqu(n.isEdit?"Edit User":"Create User"),e.xp6(2),e.Q6J("disabled",n.isSaving),e.xp6(8),e.Q6J("ngModel",n.selectedUser.username),e.xp6(2),e.Q6J("ngIf",!n.isEdit),e.xp6(1),e.Q6J("ngIf",!n.isEdit),e.xp6(5),e.Q6J("ngModel",n.selectedUser.email),e.xp6(6),e.Q6J("ngModel",n.selectedUser.user_type),e.xp6(12),e.Q6J("ngModel",n.selectedUser.agency_id),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",n.agencies)}}function C(o,a){if(1&o&&(e.TgZ(0,"div",44)(1,"div",45),e._UZ(2,"i",46),e.TgZ(3,"span"),e._uU(4),e.qZA()()()),2&o){const n=e.oxw();e.xp6(4),e.Oqu(n.isLoading?"Loading users...":"Saving user...")}}const P=[{path:"",component:(()=>{class o{constructor(n,t,i,r,g,f){this.apiService=n,this.agencyService=t,this.alertController=i,this.modalController=r,this.alertService=g,this.authService=f,this.users=[],this.agencies=[],this.selectedUser={username:"",password:"",email:"",user_type:"applicant",agency_id:null},this.isModalOpen=!1,this.isEdit=!1,this.isSaving=!1,this.isLoading=!1}ngOnInit(){this.loadUsers(),this.loadAgencies()}loadUsers(){var t,n=this;this.isLoading=!0,this.apiService.getUsers().subscribe({next:t=>{this.users=t,this.isLoading=!1},error:(t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error loading users",i),n.isLoading=!1}),function(r){return t.apply(this,arguments)})})}loadAgencies(){var t,n=this;this.agencyService.getAgencies().subscribe({next:t=>{console.log("Agencies loaded:",t),this.agencies=t||[]},error:(t=(0,c.Z)(function*(i){console.error("Error loading agencies:",i),401===i.status?yield n.authService.logout():yield n.alertService.showError("Error loading agencies",i),n.agencies=[]}),function(r){return t.apply(this,arguments)})})}openModal(n=!1,t=null){0===this.agencies.length&&(console.log("No agencies, retrying loadAgencies"),this.loadAgencies()),this.isEdit=n,this.selectedUser=n&&t?{...t}:{username:"",password:"",email:"",user_type:"applicant",agency_id:null},this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}saveUser(){var n=this;return(0,c.Z)(function*(){var t;n.isSaving=!0,n.isEdit&&n.selectedUser.id?n.apiService.updateUser(n.selectedUser.id,n.selectedUser).subscribe({next:(t=(0,c.Z)(function*(i){yield n.alertService.showSuccess("User updated"),n.loadUsers(),n.closeModal(),n.isSaving=!1}),function(r){return t.apply(this,arguments)}),error:function(){var t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error updating user",i),n.isSaving=!1});return function(r){return t.apply(this,arguments)}}()}):n.apiService.createUser(n.selectedUser).subscribe({next:function(){var t=(0,c.Z)(function*(i){yield n.alertService.showSuccess("User created"),n.loadUsers(),n.closeModal(),n.isSaving=!1});return function(r){return t.apply(this,arguments)}}(),error:function(){var t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error creating user",i),n.isSaving=!1});return function(r){return t.apply(this,arguments)}}()})})()}deleteUser(n){var t=this;return(0,c.Z)(function*(){void 0!==n&&(yield(yield t.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this user?",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:()=>{var r;t.apiService.deleteUser(n).subscribe({next:r=>{t.loadUsers()},error:(r=(0,c.Z)(function*(g){401===g.status?yield t.authService.logout():yield t.alertService.showError("Error deleting user",g)}),function(f){return r.apply(this,arguments)})})}}]})).present())})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(m.s),e.Y36(U.Y),e.Y36(s.Br),e.Y36(s.IN),e.Y36(Z.c),e.Y36(x.e))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user"]],viewQuery:function(n,t){if(1&n&&e.Gf(h,5),2&n){let i;e.iGM(i=e.CRH())&&(t.modal=i.first)}},decls:32,vars:3,consts:[["slot","start"],[1,"ion-padding"],[1,"page-content","animate__animated","animate__fadeIn"],["expand","block",1,"create-button","animate__animated","animate__bounceIn",3,"click"],[1,"fas","fa-plus-circle"],[1,"animate__animated","animate__fadeIn"],[1,"header-row"],["size","3"],[1,"fas","fa-user"],[1,"fas","fa-envelope"],[1,"fas","fa-user-tag"],["size","2"],[1,"fas","fa-building"],["size","1"],[1,"fas","fa-cogs"],[4,"ngFor","ngForOf"],[1,"user-modal",3,"isOpen","didDismiss"],["class","loading-overlay",4,"ngIf"],[1,"fas","fa-edit","action-icon",3,"click"],[1,"fas","fa-trash","action-icon",3,"click"],[1,"modal-header"],[1,"modal-button",3,"click"],[1,"fas","fa-times"],["slot","end"],[1,"modal-button",3,"disabled","click"],[1,"fas","fa-save"],[1,"ion-padding","modal-content"],[1,"modal-item"],["name","person-outline","slot","start",1,"fas","fa-user"],["position","floating"],[3,"ngModel","ngModelChange"],["class","modal-item",4,"ngIf"],[4,"ngIf"],["name","mail-outline","slot","start",1,"fas","fa-envelope"],["name","person-circle-outline","slot","start",1,"fas","fa-user-tag"],["value","superuser"],["value","agency_manager"],["value","applicant"],["name","business","slot","start",1,"fas","fa-building"],["placeholder","Select Agency",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["name","lock-closed-outline","slot","start",1,"fas","fa-lock"],["type","password",3,"ngModel","ngModelChange"],[1,"loading-overlay"],[1,"loading-spinner"],[1,"fas","fa-spinner","fa-spin"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"User"),e.qZA()()(),e.TgZ(6,"ion-content",1)(7,"div",2)(8,"ion-button",3),e.NdJ("click",function(){return t.openModal(!1)}),e._UZ(9,"i",4),e._uU(10," Create New User "),e.qZA(),e.TgZ(11,"ion-grid",5)(12,"ion-row",6)(13,"ion-col",7),e._UZ(14,"i",8),e._uU(15," Username"),e.qZA(),e.TgZ(16,"ion-col",7),e._UZ(17,"i",9),e._uU(18," Email"),e.qZA(),e.TgZ(19,"ion-col",7),e._UZ(20,"i",10),e._uU(21," User Type"),e.qZA(),e.TgZ(22,"ion-col",11),e._UZ(23,"i",12),e._uU(24," Agency ID"),e.qZA(),e.TgZ(25,"ion-col",13),e._UZ(26,"i",14),e._uU(27," Actions"),e.qZA()(),e.YNc(28,v,12,4,"ion-row",15),e.qZA(),e.TgZ(29,"ion-modal",16),e.NdJ("didDismiss",function(){return t.closeModal()}),e.YNc(30,b,47,10,"ng-template"),e.qZA()(),e.YNc(31,C,5,1,"div",17),e.qZA()),2&n&&(e.xp6(28),e.Q6J("ngForOf",t.users),e.xp6(1),e.Q6J("isOpen",t.isModalOpen),e.xp6(2),e.Q6J("ngIf",t.isLoading||t.isSaving))},directives:[s.Gu,s.sr,s.Sm,s.fG,s.wd,s.W2,s.YG,s.jY,s.Nd,s.wI,d.sg,s.ki,s.Ie,s.gu,s.Q$,s.pK,s.j9,u.JJ,u.On,d.O5,s.t9,s.QI,s.n0],styles:[".header-row[_ngcontent-%COMP%]{font-weight:700;background-color:#f4f5f8;border-bottom:1px solid #ddd}ion-col[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:8px}.fa[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.action-icon[_ngcontent-%COMP%]{margin-right:16px;cursor:pointer}.action-icon[_ngcontent-%COMP%]:hover{animation:pulse .5s}.fa-edit[_ngcontent-%COMP%]{color:#428cff}.fa-trash[_ngcontent-%COMP%]{color:#ff4961}.create-button[_ngcontent-%COMP%]{margin-bottom:16px}@media (min-width: 768px){.create-button[_ngcontent-%COMP%]{max-width:300px;margin:0 auto 16px}}.user-modal[_ngcontent-%COMP%]{--background: #ffffff;--box-shadow: 0 4px 8px rgba(0, 0, 0, .2);--border-radius: 8px;--max-width: 600px;margin:auto}.modal-header[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #428cff, #6b7280);--color: #ffffff}.modal-button[_ngcontent-%COMP%]{--border-radius: 20px;--padding-start: 12px;--padding-end: 12px;margin:0 8px}.modal-content[_ngcontent-%COMP%]{--background: #f9fafb;--padding-start: 16px;--padding-end: 16px}.modal-item[_ngcontent-%COMP%]{--background: #ffffff;--border-color: #ddd;--border-width: 0 0 1px 0;margin-bottom:16px;padding:8px 0}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:1000}.loading-spinner[_ngcontent-%COMP%]{background:#ffffff;padding:16px;border-radius:8px;display:flex;align-items:center;gap:8px}.loading-spinner[_ngcontent-%COMP%]   .fa-spinner[_ngcontent-%COMP%]{font-size:24px;color:#428cff}.loading-spinner[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:16px;color:#333}.page-content[_ngcontent-%COMP%]{animation-duration:.5s}"]}),o})()}];let A=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[p.Bz.forChild(P)],p.Bz]}),o})(),w=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[d.ez,u.u5,s.Pc,A]]}),o})()}}]);