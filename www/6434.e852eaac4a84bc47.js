"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6434],{6434:(q,_,l)=>{l.r(_),l.d(_,{UserPageModule:()=>N});var d=l(6895),s=l(4556),u=l(433),f=l(3013),c=l(5861),e=l(8256),m=l(5830),U=l(3949),h=l(5970),x=l(7556);const Z=["modal"];function v(o,r){1&o&&e._UZ(0,"ion-icon",19)}function b(o,r){1&o&&e._UZ(0,"ion-icon",20)}function M(o,r){1&o&&(e.TgZ(0,"div",21),e._UZ(1,"div",22),e.qZA())}function T(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",9),e._uU(2),e.qZA(),e.TgZ(3,"ion-col",9),e._uU(4),e.qZA(),e.TgZ(5,"ion-col",9),e._uU(6),e.qZA(),e.TgZ(7,"ion-col",13),e._uU(8),e.qZA(),e.TgZ(9,"ion-col",15)(10,"i",23),e.NdJ("click",function(){const a=e.CHM(n).$implicit;return e.oxw().openModal(!0,a)}),e.qZA(),e.TgZ(11,"i",24),e.NdJ("click",function(){const a=e.CHM(n).$implicit;return e.oxw().deleteUser(a.id)}),e.qZA()()()}if(2&o){const n=r.$implicit,t=e.oxw();e.xp6(2),e.Oqu(n.username),e.xp6(2),e.Oqu(n.email),e.xp6(2),e.Oqu(n.user_type),e.xp6(2),e.Oqu(t.getAgencyName(n.agency_id))}}function y(o,r){1&o&&e._UZ(0,"ion-icon",47)}function C(o,r){1&o&&e._UZ(0,"ion-icon",20)}function P(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"ion-item",32),e._UZ(1,"ion-icon",48),e.TgZ(2,"ion-label",34),e._uU(3,"Password"),e.qZA(),e.TgZ(4,"ion-input",49),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw(2).selectedUser.password=i}),e.qZA()()}if(2&o){const n=e.oxw(2);e.xp6(4),e.Q6J("ngModel",n.selectedUser.password)}}function A(o,r){1&o&&e._UZ(0,"br")}function w(o,r){if(1&o&&(e.TgZ(0,"ion-select-option",45),e._uU(1),e.qZA()),2&o){const n=r.$implicit;e.Q6J("value",n.id),e.xp6(1),e.Oqu(n.name)}}function S(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar",25)(2,"ion-buttons",0)(3,"ion-button",26),e.NdJ("click",function(){return e.CHM(n),e.oxw().closeModal()}),e._UZ(4,"i",27),e._uU(5," Cancel "),e.qZA()(),e.TgZ(6,"ion-title"),e._uU(7),e.qZA(),e.TgZ(8,"ion-buttons",28)(9,"ion-button",29),e.NdJ("click",function(){return e.CHM(n),e.oxw().saveUser()}),e.YNc(10,y,1,0,"ion-icon",30),e.YNc(11,C,1,0,"ion-icon",5),e._uU(12),e.qZA()()()(),e.TgZ(13,"ion-content",31)(14,"ion-item",32),e._UZ(15,"ion-icon",33),e.TgZ(16,"ion-label",34),e._uU(17,"Username"),e.qZA(),e.TgZ(18,"ion-input",35),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.username=i}),e.qZA()(),e._UZ(19,"br"),e.YNc(20,P,5,1,"ion-item",36),e.YNc(21,A,1,0,"br",37),e.TgZ(22,"ion-item",32),e._UZ(23,"ion-icon",38),e.TgZ(24,"ion-label",34),e._uU(25,"Email"),e.qZA(),e.TgZ(26,"ion-input",35),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.email=i}),e.qZA()(),e._UZ(27,"br"),e.TgZ(28,"ion-item",32),e._UZ(29,"ion-icon",39),e.TgZ(30,"ion-label",34),e._uU(31,"User Type"),e.qZA(),e.TgZ(32,"ion-select",35),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.user_type=i}),e.TgZ(33,"ion-select-option",40),e._uU(34,"Superuser"),e.qZA(),e.TgZ(35,"ion-select-option",41),e._uU(36,"Agency Manager"),e.qZA(),e.TgZ(37,"ion-select-option",42),e._uU(38,"Applicant"),e.qZA()()(),e._UZ(39,"br"),e.TgZ(40,"ion-item",32),e._UZ(41,"ion-icon",43),e.TgZ(42,"ion-label",34),e._uU(43,"Agency ID (optional)"),e.qZA(),e.TgZ(44,"ion-select",44),e.NdJ("ngModelChange",function(i){return e.CHM(n),e.oxw().selectedUser.agency_id=i}),e.TgZ(45,"ion-select-option",45),e._uU(46,"None"),e.qZA(),e.YNc(47,w,2,2,"ion-select-option",46),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(7),e.Oqu(n.isEdit?"Edit User":"Create User"),e.xp6(2),e.Q6J("disabled",n.isSaving),e.xp6(1),e.Q6J("ngIf",!n.isSaving),e.xp6(1),e.Q6J("ngIf",n.isSaving),e.xp6(1),e.hij(" ",n.isSaving?"Saving user...":"Save"," "),e.xp6(6),e.Q6J("ngModel",n.selectedUser.username),e.xp6(2),e.Q6J("ngIf",!n.isEdit),e.xp6(1),e.Q6J("ngIf",!n.isEdit),e.xp6(5),e.Q6J("ngModel",n.selectedUser.email),e.xp6(6),e.Q6J("ngModel",n.selectedUser.user_type),e.xp6(12),e.Q6J("ngModel",n.selectedUser.agency_id),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",n.agencies)}}const O=[{path:"",component:(()=>{class o{constructor(n,t,i,a,g,p){this.apiService=n,this.agencyService=t,this.alertController=i,this.modalController=a,this.alertService=g,this.authService=p,this.users=[],this.agencies=[],this.selectedUser={username:"",password:"",email:"",user_type:"applicant",agency_id:null},this.isModalOpen=!1,this.isEdit=!1,this.isSaving=!1,this.isTableLoading=!1,this.isButtonLoading=!1}ngOnInit(){this.loadUsers(),this.loadAgencies()}loadUsers(){var t,n=this;this.isTableLoading=!0,this.apiService.getUsers().subscribe({next:t=>{this.users=t,this.isTableLoading=!1},error:(t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error loading users",i),n.isTableLoading=!1}),function(a){return t.apply(this,arguments)})})}loadAgencies(){var t,n=this;this.agencyService.getAgencies().subscribe({next:t=>{console.log("Agencies loaded:",t),this.agencies=t||[]},error:(t=(0,c.Z)(function*(i){console.error("Error loading agencies:",i),401===i.status?yield n.authService.logout():yield n.alertService.showError("Error loading agencies",i),n.agencies=[]}),function(a){return t.apply(this,arguments)})})}getAgencyName(n){if(!n)return"None";const t=this.agencies.find(i=>i.id===n);return t?t.name:"None"}openModal(n=!1,t=null){0===this.agencies.length&&(console.log("No agencies, retrying loadAgencies"),this.loadAgencies()),this.isEdit=n,this.selectedUser=n&&t?{...t}:{username:"",password:"",email:"",user_type:"applicant",agency_id:null},this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}saveUser(){var n=this;return(0,c.Z)(function*(){var t;n.isSaving=!0,n.isEdit&&n.selectedUser.id?n.apiService.updateUser(n.selectedUser.id,n.selectedUser).subscribe({next:(t=(0,c.Z)(function*(i){yield n.alertService.showSuccess("User updated"),n.loadUsers(),n.closeModal(),n.isSaving=!1}),function(a){return t.apply(this,arguments)}),error:function(){var t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error updating user",i),n.isSaving=!1});return function(a){return t.apply(this,arguments)}}()}):(n.isButtonLoading=!0,n.apiService.createUser(n.selectedUser).subscribe({next:function(){var t=(0,c.Z)(function*(i){yield n.alertService.showSuccess("User created"),n.loadUsers(),n.closeModal(),n.isSaving=!1,n.isButtonLoading=!1});return function(a){return t.apply(this,arguments)}}(),error:function(){var t=(0,c.Z)(function*(i){401===i.status?yield n.authService.logout():yield n.alertService.showError("Error creating user",i),n.isSaving=!1,n.isButtonLoading=!1});return function(a){return t.apply(this,arguments)}}()}))})()}deleteUser(n){var t=this;return(0,c.Z)(function*(){void 0!==n&&(yield(yield t.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this user?",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",handler:()=>{var a;t.apiService.deleteUser(n).subscribe({next:a=>{t.loadUsers()},error:(a=(0,c.Z)(function*(g){401===g.status?yield t.authService.logout():yield t.alertService.showError("Error deleting user",g)}),function(p){return a.apply(this,arguments)})})}}]})).present())})()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(m.s),e.Y36(U.Y),e.Y36(s.Br),e.Y36(s.IN),e.Y36(h.c),e.Y36(x.e))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-user"]],viewQuery:function(n,t){if(1&n&&e.Gf(Z,5),2&n){let i;e.iGM(i=e.CRH())&&(t.modal=i.first)}},decls:33,vars:7,consts:[["slot","start"],[1,"ion-padding"],[1,"page-content","animate__animated","animate__fadeIn"],["expand","block",1,"create-button","animate__animated","animate__bounceIn",3,"disabled","click"],["name","add-circle-outline","slot","start","class","fas fa-plus-circle",4,"ngIf"],["name","loading","slot","start","class","fas fa-spinner fa-spin",4,"ngIf"],["class","loading-bar",4,"ngIf"],[1,"animate__animated","animate__fadeIn"],[1,"header-row"],["size","3"],[1,"fas","fa-user"],[1,"fas","fa-envelope"],[1,"fas","fa-user-tag"],["size","2"],[1,"fas","fa-building"],["size","1"],[1,"fas","fa-cogs"],[4,"ngFor","ngForOf"],[1,"user-modal",3,"isOpen","didDismiss"],["name","add-circle-outline","slot","start",1,"fas","fa-plus-circle"],["name","loading","slot","start",1,"fas","fa-spinner","fa-spin"],[1,"loading-bar"],[1,"loading-progress"],[1,"fas","fa-edit","action-icon",3,"click"],[1,"fas","fa-trash","action-icon",3,"click"],[1,"modal-header"],[1,"modal-button",3,"click"],[1,"fas","fa-times"],["slot","end"],[1,"modal-button",3,"disabled","click"],["name","save-outline","slot","start","class","fas fa-save",4,"ngIf"],[1,"ion-padding","modal-content"],[1,"modal-item"],["name","person-outline","slot","start",1,"fas","fa-user"],["position","floating"],[3,"ngModel","ngModelChange"],["class","modal-item",4,"ngIf"],[4,"ngIf"],["name","mail-outline","slot","start",1,"fas","fa-envelope"],["name","person-circle-outline","slot","start",1,"fas","fa-user-tag"],["value","superuser"],["value","agency_manager"],["value","applicant"],["name","business","slot","start",1,"fas","fa-building"],["placeholder","Select Agency",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["name","save-outline","slot","start",1,"fas","fa-save"],["name","lock-closed-outline","slot","start",1,"fas","fa-lock"],["type","password",3,"ngModel","ngModelChange"]],template:function(n,t){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"User"),e.qZA()()(),e.TgZ(6,"ion-content",1)(7,"div",2)(8,"ion-button",3),e.NdJ("click",function(){return t.openModal(!1)}),e.YNc(9,v,1,0,"ion-icon",4),e.YNc(10,b,1,0,"ion-icon",5),e._uU(11),e.qZA(),e.YNc(12,M,2,0,"div",6),e.TgZ(13,"ion-grid",7)(14,"ion-row",8)(15,"ion-col",9),e._UZ(16,"i",10),e._uU(17," Username"),e.qZA(),e.TgZ(18,"ion-col",9),e._UZ(19,"i",11),e._uU(20," Email"),e.qZA(),e.TgZ(21,"ion-col",9),e._UZ(22,"i",12),e._uU(23," User Type"),e.qZA(),e.TgZ(24,"ion-col",13),e._UZ(25,"i",14),e._uU(26," Agency"),e.qZA(),e.TgZ(27,"ion-col",15),e._UZ(28,"i",16),e._uU(29," Actions"),e.qZA()(),e.YNc(30,T,12,4,"ion-row",17),e.qZA(),e.TgZ(31,"ion-modal",18),e.NdJ("didDismiss",function(){return t.closeModal()}),e.YNc(32,S,48,13,"ng-template"),e.qZA()()()),2&n&&(e.xp6(8),e.Q6J("disabled",t.isButtonLoading),e.xp6(1),e.Q6J("ngIf",!t.isButtonLoading),e.xp6(1),e.Q6J("ngIf",t.isButtonLoading),e.xp6(1),e.hij(" ",t.isButtonLoading?"Creating user...":"Create New User"," "),e.xp6(1),e.Q6J("ngIf",t.isTableLoading),e.xp6(18),e.Q6J("ngForOf",t.users),e.xp6(1),e.Q6J("isOpen",t.isModalOpen))},directives:[s.Gu,s.sr,s.Sm,s.fG,s.wd,s.W2,s.YG,d.O5,s.gu,s.jY,s.Nd,s.wI,d.sg,s.ki,s.Ie,s.Q$,s.pK,s.j9,u.JJ,u.On,s.t9,s.QI,s.n0],styles:[".header-row[_ngcontent-%COMP%]{font-weight:700;background-color:#f4f5f8;border-bottom:1px solid #ddd}ion-col[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding:8px}.fa[_ngcontent-%COMP%]{font-size:18px;margin-right:8px}.action-icon[_ngcontent-%COMP%]{margin-right:16px;cursor:pointer}.action-icon[_ngcontent-%COMP%]:hover{animation:pulse .5s}.fa-edit[_ngcontent-%COMP%]{color:#428cff}.fa-trash[_ngcontent-%COMP%]{color:#ff4961}.create-button[_ngcontent-%COMP%]{margin-bottom:16px}@media (min-width: 768px){.create-button[_ngcontent-%COMP%]{max-width:300px;margin:0 auto 16px}}.user-modal[_ngcontent-%COMP%]{--background: #ffffff;--box-shadow: 0 4px 8px rgba(0, 0, 0, .2);--border-radius: 8px;--max-width: 600px;margin:auto}.modal-header[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #428cff, #6b7280);--color: #ffffff}.modal-button[_ngcontent-%COMP%]{--border-radius: 20px;--padding-start: 12px;--padding-end: 12px;margin:0 8px;display:flex;align-items:center;justify-content:center}.modal-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:18px;color:#fff}.modal-content[_ngcontent-%COMP%]{--background: #f9fafb;--padding-start: 16px;--padding-end: 16px}.modal-item[_ngcontent-%COMP%]{--background: #ffffff;--border-color: #ddd;--border-width: 0 0 1px 0;margin-bottom:16px;padding:8px 0}.loading-bar[_ngcontent-%COMP%]{width:100%;max-width:600px;margin:8px auto;height:4px;background:#e5e7eb;overflow:hidden;border-radius:2px}.loading-progress[_ngcontent-%COMP%]{width:100%;height:100%;background:#428cff;animation:loading 2s linear infinite}@keyframes loading{0%{transform:translate(-100%)}to{transform:translate(100%)}}.page-content[_ngcontent-%COMP%]{animation-duration:.5s}"]}),o})()}];let J=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.Bz.forChild(O)],f.Bz]}),o})(),N=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[d.ez,u.u5,s.Pc,J]]}),o})()}}]);